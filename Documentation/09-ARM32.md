# ARM32 Architecture

## Overview

ARM32 (ARMv7, AArch32) is the 32-bit ARM architecture used in embedded systems and older mobile devices.

## Register Set

### General Purpose Registers (32-bit)
- `r0` through `r12` - General purpose
- `r13` (sp) - Stack pointer
- `r14` (lr) - Link register (return address)
- `r15` (pc) - Program counter

### Stack Simulation
- `r4` - Stack slot 0
- `r5` - Stack slot 1
- `r6` - Stack slot 2
- `r7` - Stack slot 3

## Key Features

1. **RISC architecture** - Regular instruction set
2. **Fixed-width instructions** - 4 bytes (ARM mode)
3. **Thumb mode available** - 2-byte instructions (not used by BADGER)
4. **Conditional execution** - Most instructions can be conditional

## Calling Convention

```asm
push {r4, r5, r6, r7, lr}  ; Save registers
; Function body
pop {r4, r5, r6, r7, pc}   ; Restore and return
```

Or:

```asm
stmfd sp!, {r4-r7, lr}     ; Store multiple, decrement before
; Function body
ldmfd sp!, {r4-r7, pc}     ; Load multiple, increment after
```

## Common Instructions

### Data Movement
- `mov r0, r1` - Move register
- `mov r0, #42` - Load immediate
- `ldr r0, [r1]` - Load from memory
- `str r0, [r1]` - Store to memory

### Arithmetic
- `add r0, r1, r2` - Add
- `sub r0, r1, r2` - Subtract
- `mul r0, r1, r2` - Multiply

### Logical
- `and r0, r1, r2` - Bitwise AND
- `orr r0, r1, r2` - Bitwise OR
- `eor r0, r1, r2` - Bitwise XOR

### Control Flow
- `b label` - Branch
- `beq label` - Branch if equal
- `bne label` - Branch if not equal
- `bl label` - Branch with link (call)
- `bx lr` - Branch and exchange (return)

## Instruction Encoding

ARM32 instructions are 32 bits:

### Format
```
31  28 27  25 24  21 20 19  16 15  12 11    0
|cond|type|opcode|S|  Rn  |  Rd  | operand2|
```

### Conditional Execution

Every ARM32 instruction can be conditional:
- `addne` - Add if not equal
- `moveq` - Move if equal
- `blgt` - Branch and link if greater than

## Differences from ARM64

1. **Fewer registers** - 13 vs 31 general-purpose
2. **32-bit** - Smaller register and address size
3. **Different encoding** - Condition bits in instruction
4. **More compact** - But less regular than ARM64

## Example: Return Instruction

ARM32 return can be:
```asm
bx lr          ; Branch to link register
```
Encoding: `E12FFF1E` (little-endian: 1E FF 2F E1)
